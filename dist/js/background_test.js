!function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=56)}({56:function(e,t,n){"use strict";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(a,o){function s(e){try{c(r.next(e))}catch(e){o(e)}}function i(e){try{c(r.throw(e))}catch(e){o(e)}}function c(e){e.done?a(e.value):new n(function(t){t(e.value)}).then(s,i)}c((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,a,o,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&o[0]?r.return:o[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,o[1])).done)return a;switch(r=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(a=(a=s.trys).length>0&&a[a.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){s.label=o[1];break}if(6===o[0]&&s.label<a[1]){s.label=a[1],a=o;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(o);break}a[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{n=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}},s=this,i={network:"testnet",account:void 0,height:0},c={accountCGAS:Neo.Uint160.parse("4c7cca112a8c5666bce5da373010fc0920d0e0d2"),ID_CGAS:Neo.Uint160.parse("74f2dc36a68fdc4682034178eb2220729231db76"),DAPP_NNC:Neo.Uint160.parse("fc732edee1efdf968c23c20a9628eaa5a6ccb934"),baseContract:Neo.Uint160.parse("348387116c4a75e420663277d9c02049907128c7"),resolverHash:"6e2aea28af9c5febea0774759b1b76398e3167f1",ID_GAS:"602c79718b16e442de58778e148d0b1084e3b2dffd5de6b7b16cee7969282de7",ID_NEO:"c56f33fc6ecfcd0c225c4ab356fee59390af8560be0e930faebe74a6daff7c9b",saleContract:Neo.Uint160.parse("1b0ca9a908e07b20469917aed8d503049b420eeb"),ID_NNC:Neo.Uint160.parse("fc732edee1efdf968c23c20a9628eaa5a6ccb934"),ID_NNK:Neo.Uint160.parse("c36aee199dbba6c3f439983657558cfb67629599")},u="https://api.nel.group/api",l="https://apiwallet.nel.group/api",h="http://47.99.223.87:20332",d=function(){function e(e,t,n,r,a){this.walletName=e,this.address=t,this.nep2key=n,this.scrypt=r,void 0!==a&&(this.index=a)}return e.deciphering=function(e,t){return a(s,void 0,void 0,function(){return o(this,function(n){return[2,new Promise(function(n,r){ThinNeo.Helper.GetPrivateKeyFromNep2(t.nep2key,e,t.scrypt.N,t.scrypt.r,t.scrypt.p,function(e,a){"nep2 hash not match."==a&&r(a);var o=a;if(null!=o){var s=ThinNeo.Helper.GetPublicKeyFromPrivateKey(o),i=new p(t,o,s);n(i)}else r("prikey is null")})})]})})},e.encryption=function(t,n){return a(s,void 0,void 0,function(){return o(this,function(r){return[2,new Promise(function(r,a){var o=new Uint8Array(32),s=Neo.Cryptography.RandomNumberGenerator.getRandomValues(o),i=ThinNeo.Helper.GetPublicKeyFromPrivateKey(s),c=ThinNeo.Helper.GetAddressFromPublicKey(i),u=new ThinNeo.nep6ScryptParameters;u.N=16384,u.r=8,u.p=8,ThinNeo.Helper.GetNep2FromPrivateKey(s,t,u.N,u.r,u.p,function(t,o){"finish"==t?r(new p(new e("",c,o,u),n,i)):a(o)})})]})})},e}(),p=function(e){function t(t,n,r){var a=e.call(this,t.walletName,t.address,t.nep2key,t.scrypt,t.index)||this;return a.prikeyHex=n.toHexString(),a.pubkeyHex=r.toHexString(),a}return r(t,e),t.prototype.getPrikey=function(){return this.prikeyHex.hexToBytes()},Object.defineProperty(t.prototype,"pubkey",{get:function(){return this._pubkey=this.pubkeyHex.hexToBytes(),this._pubkey},set:function(e){this._pubkey=e,this.pubkeyHex=e.toHexString()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"prikey",{get:function(){return this._prikey=this.prikeyHex.hexToBytes(),this._prikey},set:function(e){this._prikey=e,this.prikeyHex=e.toHexString()},enumerable:!0,configurable:!0}),t}(d),f=function(){function e(e,t){this.txid=e,this.n=t}return e.setMark=function(e){for(var t=y.get("utxo_manager"),n=0;n<e.length;n++){var r=e[n];t[r.txid]?t[r.txid].push(r.n):(t[r.txid]=new Array,t[r.txid].push(r.n))}y.set("utxo_manager",t)},e.getAllUtxo=function(){return a(this,void 0,void 0,function(){var e,t,n,r,a,s,i,c,u,l;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,T.getUtxo(v.account.address)];case 1:if(!(e=o.sent()))return[2,void 0];for(t=y.get("utxo_manager"),n={},r=0,a=e;r<a.length;r++)s=a[r],(i=t?t[s.txid]:void 0)&&i.join(",").includes(s.n)||(c=s.asset,void 0!==n[c]&&null!=n[c]||(n[c]=[]),(u=new g).addr=s.addr,u.asset=s.asset,u.n=s.n,u.txid=s.txid,u.count=Neo.Fixed8.parse(s.value),n[c].push(u));return[2,n];case 2:if("-1"===(l=o.sent()).code)return[2,{}];throw l;case 3:return[2]}})})},e.getUtxoByAsset=function(e){return a(this,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getAllUtxo()];case 1:return(t=n.sent())?[2,t[e]]:[2,void 0];case 2:return n.sent(),[3,3];case 3:return[2]}})})},e}(),g=function(){return function(){}}(),m={setAccount:function(e){var t=m.getAccount(),n=0,r=new d(e.walletName,e.address,e.nep2key,e.scrypt);return t.length?(t=t.map(function(t,a){return t.address===e.address?(t.walletName=r.walletName?r.walletName:t.walletName,r.index=n=a,r):t}),n<0&&t.push(r)):t.push(r),localStorage.setItem("TEEMMOWALLET_ACCOUNT",JSON.stringify(t)),n},getAccount:function(){var e=localStorage.getItem("TEEMMOWALLET_ACCOUNT"),t=[];if(e)for(var n=t.concat(JSON.parse(e)),r=0;r<n.length;r++){var a=n[r],o=new d(a.walletName,a.address,a.nep2key,a.scrypt,r);t.push(o)}return t}},y=function(){function e(){}return e.get=function(e){return i[e]},e.set=function(e,t){i[e]=t},e}(),b=function(e){function t(t){var n=e.call(this)||this;return n.marks=[],n.type=t||ThinNeo.TransactionType.ContractTransaction,n.version=0,n.extdata=null,n.witnesses=[],n.attributes=[],n.inputs=[],n.outputs=[],n}return r(t,e),t.prototype.setScript=function(e){this.type=ThinNeo.TransactionType.InvocationTransaction,this.extdata=new ThinNeo.InvokeTransData,this.extdata.script=e,this.attributes=new Array(1),this.attributes[0]=new ThinNeo.Attribute,this.attributes[0].usage=ThinNeo.TransactionAttributeUsage.Script,this.attributes[0].data=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(v.account.address)},t.prototype.creatInuptAndOutup=function(e,t,n){for(var r=Neo.Fixed8.Zero,a="",o=e[0].asset.hexToBytes().reverse(),s=0,i=e;s<i.length;s++){var c=i[s],u=new ThinNeo.TransactionInput;if(u.hash=c.txid.hexToBytes().reverse(),u.index=c.n,u.addr=c.addr,r=r.add(c.count),a=c.addr,this.inputs.push(u),this.marks.push(new f(c.txid,c.n)),r.compareTo(t)>0)break}if(!(r.compareTo(t)>=0))throw new Error("You don't have enough utxo;");if(n&&t.compareTo(Neo.Fixed8.Zero)>0){var l=new ThinNeo.TransactionOutput;l.assetId=o,l.value=t,l.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(n),this.outputs.push(l)}var h=r.subtract(t);if(h.compareTo(Neo.Fixed8.Zero)>0){var d=new ThinNeo.TransactionOutput;d.toAddress=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(a),d.value=h,d.assetId=o,this.outputs.push(d)}},t.prototype.getTxid=function(){return this.GetHash().clone().reverse().toHexString()},t}(ThinNeo.Transaction),v=new(function(){function e(){this.tabname="account"}return Object.defineProperty(e.prototype,"network",{get:function(){return this._network=y.get("network")},set:function(e){y.set("network",e),this._network=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"accountList",{get:function(){return this._accountList&&this._accountList.length?this._accountList:m.getAccount()},set:function(e){this.accountList=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"account",{get:function(){var e=y.get(this.tabname);return new p(new d(e.walletName,e.address,e.nep2key,e.scrypt,e.index),e.prikey,e.pubkey)},set:function(e){this._account=e,y.set(this.tabname,e)},enumerable:!0,configurable:!0}),e}()),w=function(e,t){var n={jsonrpc:"2.0",id:1};return n.method=e,n.params=t,JSON.stringify(n)},N=function(e,t,n){return"/"!=e[e.length-1]&&(e+="/"),e+"?jsonrpc=2.0&id=1&method="+t+"&params="+JSON.stringify(n)};function x(e){return a(this,void 0,void 0,function(){var t,n,r,a;return o(this,function(o){switch(o.label){case 0:t=[l,v.network].join("/"),"common"===e.baseUrl?t=[u,v.network].join("/"):"rpc"===e.baseUrl&&(t=h),console.log(t),n=e.isGET?N(t,e.method,e.params):t,r=e.isGET?{method:"GET"}:{method:"POST",body:w(e.method,e.params)},o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch(n,r)];case 2:return[4,o.sent().json()];case 3:if((a=o.sent()).result)return e.getAll?[2,a]:[2,a.result];if(-1===a.error.code)return[2,null];throw new Error(a.error);case 4:throw o.sent();case 5:return[2]}})})}var T={getInvokeRead:function(e){return x({method:"invokescript",params:[e],baseUrl:"rpc"})},getnep5balanceofaddress:function(e,t){return x({method:"getnep5balanceofaddress",params:[t,e],baseUrl:"common"})},getallnep5assetofaddress:function(e){return x({method:"getallnep5assetofaddress",params:[e,1],baseUrl:"common"})},getUtxoBalance:function(e,t){return x({method:"getnep5balanceofaddress",params:[t,e],baseUrl:"common"})},getregisteraddressbalance:function(e,t){return x({method:"getregisteraddressbalance",params:[e,t]})},sendrawtransaction:function(e){return x({method:"sendrawtransaction",params:[e],baseUrl:"common"})},getUtxo:function(e){return x({method:"getutxo",params:[e],baseUrl:"common"})},getDomainInfo:function(e){return x({method:"getdomaininfo",params:[e]})},hasTx:function(e){return x({method:"hastx",params:[e]})},getrawtransaction:function(e){return x({method:"getrawtransaction",params:[e],baseUrl:"rpc"})},hasContract:function(e){return x({method:"hascontract",params:[e]})},getRehargeAndTransfer:function(e){return x({method:"getrechargeandtransfer",params:[e]})},getBlockCount:function(){return x({method:"getblockcount",params:[],baseUrl:"common"})},getBalance:function(e){return x({method:"getbalance",params:[e],baseUrl:"common"})},rechargeAndTransfer:function(e,t){return x({method:"rechargeandtransfer",params:[e,t]})},getnep5asset:function(e){return x({method:"getnep5asset",params:[e]})}};var A=function(e){for(var t="number"==typeof e?new Uint8Array(e):e,n=0;n<t.length;n++)t[n]=256*Math.random();return t},k=function(e){function t(){return e.call(this)||this}return r(t,e),t.prototype.emitInvoke=function(e,t){for(var n=e.length-1;n>=0;n--){var r=e[n];if(r.type===G.ARRAY)for(var a=r.value,o=a.length-1;o>=0;o--)this.EmitParamJson(a[o]);switch(r.type){case G.STRING:this.EmitPushString(r.value);break;case G.INTEGER:var s=new Neo.BigInteger(r.value);this.EmitPushNumber(s);break;case G.HASH160:if(20!=(i=r.value.hexToBytes()).length)throw new Error("not a hex160");this.EmitPushBytes(i.reverse());break;case G.HASH256:if(32!=(i=r.value.hexToBytes()).length)throw new Error("not a hex256");this.EmitPushBytes(i.reverse());break;case G.BYTEARRAY:var i=r.value.hexToBytes();this.EmitPushBytes(i);break;case G.BOOLEAN:s=new Neo.BigInteger(r.value?1:0);this.EmitPushNumber(s);break;case G.ADDRESS:i=ThinNeo.Helper.GetPublicKeyScriptHash_FromAddress(r.value);this.EmitPushBytes(i);break;case G.HOOKTXID:if(t){i=t.hexToBytes();this.EmitPushBytes(i.reverse())}else this.EmitSysCall("System.ExecutionEngine.GetScriptContainer"),this.EmitSysCall("Neo.Transaction.GetHash");break;case G.ARRAY:this.emitInvoke(r.value);break;default:throw new Error("No parameter of this type")}}return this.EmitPushNumber(new Neo.BigInteger(e.length)),this.Emit(ThinNeo.OpCode.PACK),this},t}(ThinNeo.ScriptBuilder);var E,S,O=function(e){return a(s,void 0,void 0,function(){var t,n,r,a,s,i,u,l,h,d,p,g,m,y,w,N,x,T,O,_;return o(this,function(o){switch(o.label){case 0:return e.merge?(_=new b,p=function(e){var t=new k,n=A(32),r=Neo.BigInteger.fromUint8Array(n);t.EmitPushNumber(r),t.Emit(ThinNeo.OpCode.DROP);for(var a=0;a<e.length;a++){var o=e[a];t.emitInvoke(o.arguments),t.EmitPushString(o.operation),t.EmitAppCall(Neo.Uint160.parse(o.scriptHash))}return t.ToArray()}(e.group),_.setScript(p),t=Neo.Fixed8.Zero,n={},[4,f.getAllUtxo()]):[3,6];case 1:for(o.sent(),void 0,O=0;O<e.group.length;O++)if((r=e.group[O]).fee&&t.add(Neo.Fixed8.parse(r.fee)),r.attachedAssets){for(s in a=ThinNeo.Helper.GetAddressFromScriptHash(Neo.Uint160.parse(r.scriptHash)),r.attachedAssets)r.attachedAssets.hasOwnProperty(s)&&(r.attachedAssets[s],c.ID_GAS);n[a]=r.attachedAssets}o.label=2;case 2:return o.trys.push([2,4,,5]),[4,P(_)];case 3:return h=o.sent(),C.addTask(new R(E.tranfer,h.txid.replace("0x",""))),[2,[h]];case 4:throw o.sent();case 5:return[3,15];case 6:i=[],u=[],O=0,o.label=7;case 7:if(!(O<e.group.length))return[3,14];if(l=e.group[O],console.log(l),0!=O)return[3,12];o.label=8;case 8:return o.trys.push([8,10,,11]),[4,H(l)];case 9:return h=o.sent(),console.log(h),i.push(h),[3,11];case 10:throw d=o.sent(),console.log(d),d;case 11:return[3,13];case 12:_=new b,p=new k,g=A(32),m=Neo.BigInteger.fromUint8Array(g),p.EmitPushNumber(m),p.Emit(ThinNeo.OpCode.DROP),p.emitInvoke(l.arguments,i[0].txid),p.EmitPushString(l.operation),p.EmitAppCall(Neo.Uint160.parse(l.scriptHash)),_.setScript(p.ToArray()),y=_.GetMessage().clone(),w=ThinNeo.Helper.Sign(y,v.account.prikey),_.AddWitness(w,v.account.pubkey,v.account.address),N=_.GetRawData(),(x=new U).txhex=N.toHexString(),x.txid=_.getTxid(),i.push({txid:x.txid,nodeUrl:"https://api.nel.group/api"}),u.push(x),o.label=13;case 13:return O++,[3,7];case 14:for(T=new R(E.tranfer,i[0].txid.replace("0x",""),u[0],S.watting),C.addTask(T),O=0;O<u.length;O++)_=u[O],O<u.length-1?C.addTask(new R(E.tranfer,_.txid,u[O+1],S.watForLast)):C.addTask(new R(E.tranfer,_.txid,void 0,S.watForLast));return[2,i];case 15:return[2]}})})},P=function(e){return a(s,void 0,void 0,function(){var t,n,r,a,s;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),t=e.GetMessage().clone(),n=ThinNeo.Helper.Sign(t,v.account.prikey),e.AddWitness(n,v.account.pubkey,v.account.address),r=e.GetRawData(),console.log(r.toHexString()),[4,T.sendrawtransaction(r.toHexString())];case 1:if((a=o.sent())[0].txid)return[2,{txid:a[0].txid,nodeUrl:"https://api.nel.group/api"}];throw{type:"TransactionError",description:a[0].errorMessage,data:""};case 2:return s=o.sent(),console.log(s),[3,3];case 3:return[2]}})})},H=function(e){return a(s,void 0,void 0,function(){var t,n,r,a,s,i,u,l,h;return o(this,function(o){switch(o.label){case 0:t=new b;try{n=new k,r=A(32),a=Neo.BigInteger.fromUint8Array(r),n.EmitPushNumber(a),n.Emit(ThinNeo.OpCode.DROP),n.emitInvoke(e.arguments),n.EmitPushString(e.operation),n.EmitAppCall(Neo.Uint160.parse(e.scriptHash)),t.setScript(n.ToArray())}catch(e){throw e}if(!e.fee||""===e.fee||"0"==e.fee)return[3,4];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,f.getUtxoByAsset(c.ID_GAS)];case 2:return(s=o.sent())&&t.creatInuptAndOutup(s,Neo.Fixed8.parse(e.fee)),[3,4];case 3:throw o.sent();case 4:return o.trys.push([4,6,,7]),i=t.GetMessage().clone(),u=ThinNeo.Helper.Sign(i,v.account.prikey),t.AddWitness(u,v.account.pubkey,v.account.address),l=t.GetRawData(),[4,T.sendrawtransaction(l.toHexString())];case 5:if((h=o.sent())[0].txid)return console.log(l.toHexString()),[2,{txid:h[0].txid,nodeUrl:"https://api.nel.group/api"}];throw{type:"TransactionError",description:h[0].errorMessage,data:l.toHexString()};case 6:throw o.sent();case 7:return[2]}})})},_=function(e,t){if(e)chrome.storage.local.set({data:e},function(){var e=window.open("notify.html","notify","height=636px, width=391px, top=0, left=0, toolbar=no, menubar=no, scrollbars=no,resizable=no,location=no, status=no"),n=setInterval(function(){e.closed&&(t(),clearInterval(n))},1e3)});else var n=window.open("notify.html","notify","height=636px, width=391px, top=0, left=0, toolbar=no, menubar=no, scrollbars=no,resizable=no,location=no, status=no"),r=setInterval(function(){n.closed&&(t(),clearInterval(r))},1e3)},I=function(e){var t=e.ID,n=e.command,r=e.message,u=e.params;chrome.tabs.query({active:!0,currentWindow:!0},function(l){var h=function(e){e.then(function(e){chrome.tabs.sendMessage(l[0].id,{return:n,ID:t,data:e})}).catch(function(e){chrome.tabs.sendMessage(l[0].id,{return:n,ID:t,error:e})})};switch(e.command){case D.getProvider:h(new Promise(function(e,t){e({compatibility:[""],extra:{theme:"",currency:""},name:"Teemmo.NEO",version:F,website:""})}));break;case D.getNetworks:h(new Promise(function(e,t){e({networks:["mainnet","testnet"],defaultNetwork:i.network?i.network:"testnet"})}));break;case D.getAccount:h(function(e){return new Promise(function(t,n){i.account||n({type:"ACCOUNT_ERROR",deciphering:"Account not logged in "});var r=i.account,a=r.address,o=r.walletName,s={lable:D.getAccount,header:e,account:{address:a,walletName:o}};_(s,function(){chrome.storage.local.get("confirm",function(e){"confirm"===e.confirm?i.account?t({address:i.account.address,label:i.account.walletName}):n({type:"AccountError",description:"Account not logged in"}):"cancel"===e.confirm&&n({type:"AccountError",description:"User cancel Authorization "})})})})}(r));break;case D.getBalance:h(function(e){return a(s,void 0,void 0,function(){var t,n,r,a,s,i,u,l,h,d,p,f,g,m,y,b,v,w,N,x,A,k,E,S,O,P,H,_,I,R,U;return o(this,function(o){switch(o.label){case 0:Array.isArray(e.params)||(e.params=[e.params]),e.params.forEach(function(t,n){var r=t.address,a=t.assets,o=t.fetchUTXO;a&&!Array.isArray(a)&&(e.params[n]={address:r,assets:[a],fetchUTXO:o})}),t={},Array.isArray(e.params)||(e.params=[e.params]),n=0,r=e.params,o.label=1;case 1:if(!(n<r.length))return[3,9];for(a=r[n],s=a.assets?a.assets:[c.ID_GAS,c.ID_NEO,c.ID_NNC.toString(),c.ID_NNK.toString()],i=[],u=[],l=[],h=0,d=s;h<d.length;h++)40==(U=d[h]).length?i.push(U):u.push(U);if(!i.length)return[3,5];o.label=2;case 2:return o.trys.push([2,4,,5]),[4,T.getallnep5assetofaddress(a.address)];case 3:for(v=o.sent(),w={},p=0,f=v;p<f.length;p++)A=f[p],m=(g=A).assetid,P=g.symbol,S=g.balance,H=m.replace("0x",""),w[H]={assetID:H,symbol:P,amount:S};for(y=0,b=i;y<b.length;y++)U=b[y],w[U]&&l.push(w[U]);return[3,5];case 4:throw{type:"NETWORK_ERROR",description:"余额查询失败",data:o.sent()};case 5:return u.length?[4,T.getBalance(a.address)]:[3,7];case 6:for(v=o.sent(),w={},N=0,x=v;N<x.length;N++){if(A=x[N],E=(k=A).asset,S=k.balance,O=k.name,P="",(H=E.replace("0x",""))==c.ID_GAS)P="GAS";else if(H==c.ID_NEO)P="NEO";else for(_ in O)if(P=O[_].name,"en"==O[_].lang)break;w[H]={assetID:H,symbol:P,amount:S}}for(I=0,R=u;I<R.length;I++)U=R[I],w[U]&&l.push(w[U]);o.label=7;case 7:t[a.address]=l,o.label=8;case 8:return n++,[3,1];case 9:return[2,t]}})})}(u));break;case D.getStorage:case D.getPublicKey:break;case D.invoke:h(function(e,t){return new Promise(function(n,r){i.account||r({type:"ACCOUNT_ERROR",description:"this account is undefind"});var a=i.account,o=a.address,s=a.walletName,c={lable:D.invokeGroup,header:e,account:{address:o,walletName:s},data:t};_(c,function(){chrome.storage.local.get("confirm",function(e){"confirm"===e.confirm?H(t).then(function(e){n(e)}).catch(function(e){r(e)}):"cancel"===e.confirm&&r({type:"TransactionError",description:"User cancel Authorization "})})})})}(r,u));break;case D.send:h(new Promise(function(e,t){}));break;case D.invokeRead:h(function(e){return new Promise(function(t,n){var r=new k;try{r.emitInvoke(e.arguments),r.EmitPushString(e.operation),r.EmitAppCall(Neo.Uint160.parse(e.scriptHash)),T.getInvokeRead(r.ToArray().toHexString()).then(function(e){t(e)}).then(function(e){n(e)})}catch(e){n(e)}})}(u));break;case D.invokeGroup:h(function(e,t){return new Promise(function(n,r){i.account||r({type:"ACCOUNT_ERROR",description:"this account is undefind"});var a=i.account,o=a.address,s=a.walletName,c={lable:D.invokeGroup,header:e,account:{address:o,walletName:s},data:t};_(c,function(){chrome.storage.local.get("confirm",function(e){"confirm"===e.confirm?O(t).then(function(e){n(e)}).catch(function(e){r(e)}):"cancel"===e.confirm&&r({type:"TransactionError",description:"User cancel Authorization "})})})})}(r,u));case D.invokeReadGroup:h(function(e){return new Promise(function(t,n){var r=new k;try{for(var a=0,o=e.group;a<o.length;a++){var s=o[a];r.emitInvoke(s.arguments),r.EmitPushString(s.operation),r.EmitAppCall(Neo.Uint160.parse(s.scriptHash))}T.getInvokeRead(r.ToArray().toHexString()).then(function(e){t(e)}).then(function(e){n(e)})}catch(e){n(e)}})}(u))}})};chrome.runtime.onMessage.addListener(function(e,t,n){I(e)}),function(e){e[e.tranfer=0]="tranfer",e[e.contract=1]="contract"}(E||(E={})),function(e){e[e.watting=0]="watting",e[e.success=1]="success",e[e.fail=2]="fail",e[e.watForLast=3]="watForLast",e[e.failForLast=4]="failForLast"}(S||(S={}));var R=function(){return function(e,t,n,r,a){this.height=i.height,this.type=e,this.confirm=0,this.txid=t,this.next=n,this.state=r||S.watting,this.message=a,this.startTime=(new Date).getTime()}}(),U=function(){function e(){}return e.update=function(e){console.log("-------------------------------------TransferGroup-update"),T.sendrawtransaction(e.txhex).then(function(t){t?C.shed[e.txid].state=S.watting:(C.shed[e.txid].state=S.fail,e.executeError={type:"TransferError",description:t[0].errorMessage,data:e.txhex})}).catch(function(t){t&&(e.executeError={type:"TransferError",description:"",data:t})})},e}(),C=function(){function e(){}return e.start=function(){var e=this;setInterval(function(){console.log("-----------------进来了"),T.getBlockCount().then(function(t){var n=parseInt(t[0].blockcount)-1;n-i.height>0&&(i.height=n,console.log(i.height),e.update())}).catch(function(e){console.log(e)})},15e3)},e.addTask=function(e){this.shed[e.txid]=e},e.update=function(){var e=this;console.log("------------------进入了 TaskManager.update ");var t=function(t){var r=n.shed[t];r.state==S.watting&&(r.type===E.tranfer?T.getrawtransaction(r.txid).then(function(n){n&&(console.log(r.txid+"       该交易查询成功"),r.state=S.success,console.log("状态变更"),console.log(r),e.shed[t]=r,r.next&&U.update(r.next))}).catch(function(e){console.log(e)}):T.hasContract(r.txid).then(function(e){console.log(e)}).catch(function(e){console.log(e)}))},n=this;for(var r in this.shed)t(r)},e.shed={},e}();C.start();var G,D,B,F="v1";!function(e){e.STRING="String",e.BOOLEAN="Boolean",e.HASH160="Hash160",e.HASH256="Hash256",e.INTEGER="Integer",e.BYTEARRAY="ByteArray",e.ARRAY="Array",e.ADDRESS="Address",e.HOOKTXID="Hook_Txid"}(G||(G={})),function(e){e.isReady="isReady",e.getProvider="getProvider",e.getNetworks="getNetworks",e.getAccount="getAccount",e.getPublicKey="getPublicKey",e.getBalance="getBalance",e.getStorage="getStorage",e.invokeRead="invokeRead",e.invokeReadGroup="invokeReadGroup",e.send="send",e.invoke="invoke",e.invokeGroup="invokeGroup",e.event="event",e.disconnect="disconnect"}(D||(D={})),function(e){e.READY="READY",e.ACCOUNT_CHANGED="ACCOUNT_CHANGED",e.CONNECTED="CONNECTED",e.DISCONNECTED="DISCONNECTED",e.NETWORK_CHANGED="NETWORK_CHANGED"}(B||(B={}))}});